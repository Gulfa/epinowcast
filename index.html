<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Nowcast Right Censored Epidemiological Counts • epinowcast</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="preferably.css">
<link id="css-code-light" rel="stylesheet" href="code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<script src="darkswitch.js"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Nowcast Right Censored Epidemiological Counts">
<meta property="og:description" content="Tools to enable flexible and efficient nowcasting of  right
    censored epidemiological counts using a semi-mechanistic method with
    adjustment available for both day of reference and day of report effects. ">
<meta property="og:image" content="samabbott.co.uk/epinowcast/reference/figures/README-unnamed-chunk-8-1.png">
<meta property="og:image:alt" content="An R package for nowcasting right censored epidemiolgical counts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">epinowcast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.1000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/model-definitions.html">Model definition</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://github.com/seabbs/epinowcast/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="nowcast-right-censored-epidemological-counts">Nowcast right censored epidemological counts<a class="anchor" aria-label="anchor" href="#nowcast-right-censored-epidemological-counts"></a>
</h1></div>

<p><a href="https://github.com/seabbs/epinowcast/graphs/contributors" class="external-link"><img src="https://img.shields.io/github/contributors/seabbs/epinowcast" alt="GitHub contributors"></a></p>
<p>This package contains tools to enable flexible and efficient nowcasting of right censored epidemiological counts using a semi-mechanistic method with adjustment available for both day of reference and day of report effects.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h3>
<p>Install the unstable development from GitHub using the following,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"seabbs/epinowcast"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="installing-cmdstan">Installing CmdStan<a class="anchor" aria-label="anchor" href="#installing-cmdstan"></a>
</h3>
<p>If you don’t already have CmdStan installed then, in addition to installing <code>epinowcast</code>, it is also necessary to install CmdStan using CmdStanR’s <code>install_cmdstan()</code> function to enable model fitting in <code>epinowcast</code>. A suitable C++ toolchain is also required. Instructions are provided in the <a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html" class="external-link"><em>Getting started with CmdStanR</em></a> vignette. See the <a href="https://mc-stan.org/cmdstanr/" class="external-link">CmdStanR documentation</a> for further details and support.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://samabbott.co.uk/epinowcast/">epinowcast</a></span><span class="op">)</span>

<span class="va">national_germany_hosp</span> <span class="op">&lt;-</span> <span class="va">germany_covid19_hosp</span>
<span class="va">national_germany_hosp</span> <span class="op">&lt;-</span> <span class="va">national_germany_hosp</span><span class="op">[</span><span class="va">location</span> <span class="op">==</span> <span class="st">"DE"</span><span class="op">]</span>
<span class="va">national_germany_hosp</span> <span class="op">&lt;-</span> <span class="va">national_germany_hosp</span><span class="op">[</span><span class="va">age_group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"00+"</span><span class="op">]</span>

<span class="va">nat_germany_30_days_ago</span> <span class="op">&lt;-</span>
  <span class="va">national_germany_hosp</span><span class="op">[</span><span class="va">report_date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">report_date</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span><span class="op">]</span>
<span class="va">nat_germany_30_days_ago</span> <span class="op">&lt;-</span>
  <span class="va">nat_germany_30_days_ago</span><span class="op">[</span><span class="va">reference_date</span> <span class="op">&gt;=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reference_date</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span><span class="op">)</span><span class="op">]</span>
<span class="va">nat_germany_30_days_ago</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;      reference_date location age_group confirm report_date</span>
<span class="co">#&gt;   1:     2021-08-21       DE       00+      69  2021-08-21</span>
<span class="co">#&gt;   2:     2021-08-22       DE       00+      45  2021-08-22</span>
<span class="co">#&gt;   3:     2021-08-23       DE       00+      28  2021-08-23</span>
<span class="co">#&gt;   4:     2021-08-24       DE       00+     136  2021-08-24</span>
<span class="co">#&gt;   5:     2021-08-25       DE       00+     128  2021-08-25</span>
<span class="co">#&gt;  ---                                                      </span>
<span class="co">#&gt; 492:     2021-08-22       DE       00+     239  2021-09-19</span>
<span class="co">#&gt; 493:     2021-08-23       DE       00+     186  2021-09-20</span>
<span class="co">#&gt; 494:     2021-08-21       DE       00+     323  2021-09-19</span>
<span class="co">#&gt; 495:     2021-08-22       DE       00+     239  2021-09-20</span>
<span class="co">#&gt; 496:     2021-08-21       DE       00+     323  2021-09-20</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">latest_germany_hosp</span> <span class="op">&lt;-</span> <span class="va">national_germany_hosp</span><span class="op">[</span><span class="va">report_date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">report_date</span><span class="op">)</span><span class="op">]</span>
                  
<span class="va">latest_germany_hosp</span> <span class="op">&lt;-</span>
  <span class="va">latest_germany_hosp</span><span class="op">[</span><span class="va">reference_date</span> <span class="op">&gt;=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reference_date</span><span class="op">)</span> <span class="op">-</span> <span class="fl">60</span><span class="op">)</span><span class="op">]</span>
<span class="va">latest_germany_hosp</span> <span class="op">&lt;-</span>
  <span class="va">latest_germany_hosp</span><span class="op">[</span><span class="va">reference_date</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">reference_date</span><span class="op">)</span> <span class="op">-</span> <span class="fl">30</span><span class="op">)</span><span class="op">]</span>
<span class="va">latest_germany_hosp</span><span class="op">[</span><span class="op">]</span>
<span class="co">#&gt;     reference_date location age_group confirm report_date</span>
<span class="co">#&gt;  1:     2021-09-20       DE       00+     146  2021-10-20</span>
<span class="co">#&gt;  2:     2021-09-19       DE       00+     275  2021-10-20</span>
<span class="co">#&gt;  3:     2021-09-18       DE       00+     385  2021-10-20</span>
<span class="co">#&gt;  4:     2021-09-17       DE       00+     412  2021-10-20</span>
<span class="co">#&gt;  5:     2021-09-16       DE       00+     481  2021-10-20</span>
<span class="co">#&gt;  6:     2021-09-15       DE       00+     515  2021-10-20</span>
<span class="co">#&gt;  7:     2021-09-14       DE       00+     431  2021-10-20</span>
<span class="co">#&gt;  8:     2021-09-13       DE       00+     204  2021-10-20</span>
<span class="co">#&gt;  9:     2021-09-12       DE       00+     330  2021-10-20</span>
<span class="co">#&gt; 10:     2021-09-11       DE       00+     482  2021-10-20</span>
<span class="co">#&gt; 11:     2021-09-10       DE       00+     515  2021-10-20</span>
<span class="co">#&gt; 12:     2021-09-09       DE       00+     540  2021-10-20</span>
<span class="co">#&gt; 13:     2021-09-08       DE       00+     615  2021-10-20</span>
<span class="co">#&gt; 14:     2021-09-07       DE       00+     455  2021-10-20</span>
<span class="co">#&gt; 15:     2021-09-06       DE       00+     214  2021-10-20</span>
<span class="co">#&gt; 16:     2021-09-05       DE       00+     360  2021-10-20</span>
<span class="co">#&gt; 17:     2021-09-04       DE       00+     484  2021-10-20</span>
<span class="co">#&gt; 18:     2021-09-03       DE       00+     501  2021-10-20</span>
<span class="co">#&gt; 19:     2021-09-02       DE       00+     541  2021-10-20</span>
<span class="co">#&gt; 20:     2021-09-01       DE       00+     628  2021-10-20</span>
<span class="co">#&gt; 21:     2021-08-31       DE       00+     445  2021-10-20</span>
<span class="co">#&gt; 22:     2021-08-30       DE       00+     227  2021-10-20</span>
<span class="co">#&gt; 23:     2021-08-29       DE       00+     374  2021-10-20</span>
<span class="co">#&gt; 24:     2021-08-28       DE       00+     464  2021-10-20</span>
<span class="co">#&gt; 25:     2021-08-27       DE       00+     479  2021-10-20</span>
<span class="co">#&gt; 26:     2021-08-26       DE       00+     543  2021-10-20</span>
<span class="co">#&gt; 27:     2021-08-25       DE       00+     592  2021-10-20</span>
<span class="co">#&gt; 28:     2021-08-24       DE       00+     468  2021-10-20</span>
<span class="co">#&gt; 29:     2021-08-23       DE       00+     206  2021-10-20</span>
<span class="co">#&gt; 30:     2021-08-22       DE       00+     267  2021-10-20</span>
<span class="co">#&gt; 31:     2021-08-21       DE       00+     345  2021-10-20</span>
<span class="co">#&gt;     reference_date location age_group confirm report_date</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preprocessing-and-model-specification">Data preprocessing and model specification<a class="anchor" aria-label="anchor" href="#data-preprocessing-and-model-specification"></a>
</h3>
<p>Process reported data into format required for <a href="https://samabbott.co.uk/epinowcast/">epinowcast</a> and return in a <a href="https://r-datatable.com" class="external-link">data.table</a>. At this stage specify grouping (i.e age, location) if any.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enw_preprocess_data.html">enw_preprocess_data</a></span><span class="op">(</span><span class="va">nat_germany_30_days_ago</span>, max_delay <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">pobs</span>
<span class="co">#&gt;                    obs         new_confirm             latest</span>
<span class="co">#&gt; 1: &lt;data.table[495x6]&gt; &lt;data.table[495x8]&gt; &lt;data.table[31x5]&gt;</span>
<span class="co">#&gt;                   diff  reporting_triangle      metareference</span>
<span class="co">#&gt; 1: &lt;data.table[495x8]&gt; &lt;data.table[31x32]&gt; &lt;data.table[31x4]&gt;</span>
<span class="co">#&gt;            metareport time snapshots groups max_delay   max_date</span>
<span class="co">#&gt; 1: &lt;data.table[60x5]&gt;   31        31      1        30 2021-09-20</span></code></pre></div>
<p>Construct an intercept only model for the date of reference.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reference_effects</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enw_intercept_model.html">enw_intercept_model</a></span><span class="op">(</span><span class="va">pobs</span><span class="op">$</span><span class="va">metareference</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">reference_effects</span>
<span class="co">#&gt; $fixed</span>
<span class="co">#&gt; $fixed$design</span>
<span class="co">#&gt;   (Intercept)</span>
<span class="co">#&gt; 1           1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fixed$index</span>
<span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $random</span>
<span class="co">#&gt; $random$design</span>
<span class="co">#&gt;      (Intercept)</span>
<span class="co">#&gt; attr(,"assign")</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $random$index</span>
<span class="co">#&gt; integer(0)</span></code></pre></div>
<p>Construct a model with a random effect for the day of report.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">report_effects</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enw_day_of_week_model.html">enw_day_of_week_model</a></span><span class="op">(</span><span class="va">pobs</span><span class="op">$</span><span class="va">metareport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">report_effects</span>
<span class="co">#&gt; $fixed</span>
<span class="co">#&gt; $fixed$design</span>
<span class="co">#&gt;   (Intercept) day_of_weekFriday day_of_weekMonday day_of_weekSaturday</span>
<span class="co">#&gt; 1           1                 0                 0                   1</span>
<span class="co">#&gt; 2           1                 0                 0                   0</span>
<span class="co">#&gt; 3           1                 0                 1                   0</span>
<span class="co">#&gt; 4           1                 0                 0                   0</span>
<span class="co">#&gt; 5           1                 0                 0                   0</span>
<span class="co">#&gt; 6           1                 0                 0                   0</span>
<span class="co">#&gt; 7           1                 1                 0                   0</span>
<span class="co">#&gt;   day_of_weekSunday day_of_weekThursday day_of_weekTuesday day_of_weekWednesday</span>
<span class="co">#&gt; 1                 0                   0                  0                    0</span>
<span class="co">#&gt; 2                 1                   0                  0                    0</span>
<span class="co">#&gt; 3                 0                   0                  0                    0</span>
<span class="co">#&gt; 4                 0                   0                  1                    0</span>
<span class="co">#&gt; 5                 0                   0                  0                    1</span>
<span class="co">#&gt; 6                 0                   1                  0                    0</span>
<span class="co">#&gt; 7                 0                   0                  0                    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fixed$index</span>
<span class="co">#&gt;  [1] 1 2 3 4 5 6 7 1 2 3 4 5 6 7 1 2 3 4 5 6 7 1 2 3 4 5 6 7 1 2 3 4 5 6 7 1 2 3</span>
<span class="co">#&gt; [39] 4 5 6 7 1 2 3 4 5 6 7 1 2 3 4 5 6 7 1 2 3 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $random</span>
<span class="co">#&gt; $random$design</span>
<span class="co">#&gt;   fixed sd</span>
<span class="co">#&gt; 1     0  1</span>
<span class="co">#&gt; 2     0  1</span>
<span class="co">#&gt; 3     0  1</span>
<span class="co">#&gt; 4     0  1</span>
<span class="co">#&gt; 5     0  1</span>
<span class="co">#&gt; 6     0  1</span>
<span class="co">#&gt; 7     0  1</span>
<span class="co">#&gt; attr(,"assign")</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $random$index</span>
<span class="co">#&gt; [1] 1 2 3 4 5 6 7</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">nowcast</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/epinowcast.html">epinowcast</a></span><span class="op">(</span><span class="va">pobs</span>,
  report_effects <span class="op">=</span> <span class="va">report_effects</span>,
  reference_effects <span class="op">=</span> <span class="va">reference_effects</span>,
  save_warmup <span class="op">=</span> <span class="cn">FALSE</span>, pp <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; Init values were only set for a subset of parameters. </span>
<span class="co">#&gt; Missing init values for the following parameters:</span>
<span class="co">#&gt;  - chain 1: leobs_init, leobs_resids, logmean_eff, logsd_eff, logmean_sd, logsd_sd, rd_eff_sd</span>
<span class="co">#&gt;  - chain 2: leobs_init, leobs_resids, logmean_eff, logsd_eff, logmean_sd, logsd_sd, rd_eff_sd</span>
<span class="co">#&gt;  - chain 3: leobs_init, leobs_resids, logmean_eff, logsd_eff, logmean_sd, logsd_sd, rd_eff_sd</span>
<span class="co">#&gt;  - chain 4: leobs_init, leobs_resids, logmean_eff, logsd_eff, logmean_sd, logsd_sd, rd_eff_sd</span>
<span class="co">#&gt; Running MCMC with 4 parallel chains...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is nan, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 1 Exception: neg_binomial_2_lpmf: Location parameter[1] is -nan, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 1</span>
<span class="co">#&gt; Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 2 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 2</span>
<span class="co">#&gt; Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 2 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 2</span>
<span class="co">#&gt; Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 2 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 2</span>
<span class="co">#&gt; Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 2 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 2</span>
<span class="co">#&gt; Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 2 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 2</span>
<span class="co">#&gt; Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[21] is nan, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[24] is nan, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 3 Exception: neg_binomial_2_lpmf: Location parameter[29] is nan, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 3</span>
<span class="co">#&gt; Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup)</span>
<span class="co">#&gt; Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 4 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 4</span>
<span class="co">#&gt; Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 4 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 4</span>
<span class="co">#&gt; Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 4 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 4</span>
<span class="co">#&gt; Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 4 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 4</span>
<span class="co">#&gt; Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</span>
<span class="co">#&gt; Chain 4 Exception: neg_binomial_2_lpmf: Location parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpBBHbGH/model-17f64226d848a.stan', line 156, column 6 to column 53)</span>
<span class="co">#&gt; Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</span>
<span class="co">#&gt; Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</span>
<span class="co">#&gt; Chain 4</span>
<span class="co">#&gt; Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 finished in 56.7 seconds.</span>
<span class="co">#&gt; Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 finished in 57.6 seconds.</span>
<span class="co">#&gt; Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 finished in 58.2 seconds.</span>
<span class="co">#&gt; Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 finished in 59.3 seconds.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All 4 chains finished successfully.</span>
<span class="co">#&gt; Mean chain execution time: 57.9 seconds.</span>
<span class="co">#&gt; Total execution time: 59.4 seconds.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>Print the output from <a href="https://samabbott.co.uk/epinowcast/">epinowcast</a> which includes diagnostic information, the data used for fitting, and the <code>{cmdstanr</code>} object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nowcast</span>
<span class="co">#&gt;                    obs         new_confirm             latest</span>
<span class="co">#&gt; 1: &lt;data.table[495x6]&gt; &lt;data.table[495x8]&gt; &lt;data.table[31x5]&gt;</span>
<span class="co">#&gt;                   diff  reporting_triangle      metareference</span>
<span class="co">#&gt; 1: &lt;data.table[495x8]&gt; &lt;data.table[31x32]&gt; &lt;data.table[31x4]&gt;</span>
<span class="co">#&gt;            metareport time snapshots groups max_delay   max_date</span>
<span class="co">#&gt; 1: &lt;data.table[60x5]&gt;   31        31      1        30 2021-09-20</span>
<span class="co">#&gt;                  fit       data  fit_args samples max_rhat</span>
<span class="co">#&gt; 1: &lt;CmdStanMCMC[31]&gt; &lt;list[29]&gt; &lt;list[2]&gt;    4000        1</span>
<span class="co">#&gt;    divergent_transitions per_divergent_transitions max_treedepth</span>
<span class="co">#&gt; 1:                     0                         0             7</span>
<span class="co">#&gt;    no_at_max_treedepth per_at_max_treedepth time</span>
<span class="co">#&gt; 1:                3201              0.80025 59.4</span></code></pre></div>
<p>Summarise the nowcast for the latest snapshot of data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nowcast</span><span class="op">)</span>
<span class="co">#&gt;     reference_date group location age_group confirm     mean median         sd</span>
<span class="co">#&gt;  1:     2021-08-22     1       DE       00+     239 239.0000    239  0.0000000</span>
<span class="co">#&gt;  2:     2021-08-23     1       DE       00+     186 186.6085    186  0.8039834</span>
<span class="co">#&gt;  3:     2021-08-24     1       DE       00+     437 439.1180    439  1.5754988</span>
<span class="co">#&gt;  4:     2021-08-25     1       DE       00+     539 543.8100    544  2.5243798</span>
<span class="co">#&gt;  5:     2021-08-26     1       DE       00+     509 515.9407    516  3.0417187</span>
<span class="co">#&gt;  6:     2021-08-27     1       DE       00+     442 450.4220    450  3.3925349</span>
<span class="co">#&gt;  7:     2021-08-28     1       DE       00+     412 422.8603    423  3.8081945</span>
<span class="co">#&gt;  8:     2021-08-29     1       DE       00+     322 333.9688    334  3.9962815</span>
<span class="co">#&gt;  9:     2021-08-30     1       DE       00+     204 212.1047    212  3.1768381</span>
<span class="co">#&gt; 10:     2021-08-31     1       DE       00+     409 423.2842    423  4.3780411</span>
<span class="co">#&gt; 11:     2021-09-01     1       DE       00+     535 563.6680    563  6.7576766</span>
<span class="co">#&gt; 12:     2021-09-02     1       DE       00+     475 507.0697    507  7.2276168</span>
<span class="co">#&gt; 13:     2021-09-03     1       DE       00+     444 479.2435    479  7.8597488</span>
<span class="co">#&gt; 14:     2021-09-04     1       DE       00+     437 482.1678    482  9.0468819</span>
<span class="co">#&gt; 15:     2021-09-05     1       DE       00+     310 348.9733    349  8.1113490</span>
<span class="co">#&gt; 16:     2021-09-06     1       DE       00+     190 215.7240    215  6.3542835</span>
<span class="co">#&gt; 17:     2021-09-07     1       DE       00+     395 440.6355    440  8.8994629</span>
<span class="co">#&gt; 18:     2021-09-08     1       DE       00+     518 600.9025    600 13.4988166</span>
<span class="co">#&gt; 19:     2021-09-09     1       DE       00+     433 519.2392    518 13.9083381</span>
<span class="co">#&gt; 20:     2021-09-10     1       DE       00+     395 490.1393    489 15.3756939</span>
<span class="co">#&gt; 21:     2021-09-11     1       DE       00+     365 483.7532    483 18.5615731</span>
<span class="co">#&gt; 22:     2021-09-12     1       DE       00+     239 332.5013    332 15.2740408</span>
<span class="co">#&gt; 23:     2021-09-13     1       DE       00+     147 211.6585    211 12.0662246</span>
<span class="co">#&gt; 24:     2021-09-14     1       DE       00+     324 429.6467    428 17.7670026</span>
<span class="co">#&gt; 25:     2021-09-15     1       DE       00+     313 459.0930    458 23.5432245</span>
<span class="co">#&gt; 26:     2021-09-16     1       DE       00+     289 488.9340    487 32.1973805</span>
<span class="co">#&gt; 27:     2021-09-17     1       DE       00+     203 422.4830    419 37.9803546</span>
<span class="co">#&gt; 28:     2021-09-18     1       DE       00+     144 433.8562    429 52.8565137</span>
<span class="co">#&gt; 29:     2021-09-19     1       DE       00+      73 402.4815    395 68.2205773</span>
<span class="co">#&gt; 30:     2021-09-20     1       DE       00+      23 319.9647    309 83.9976869</span>
<span class="co">#&gt;     reference_date group location age_group confirm     mean median         sd</span>
<span class="co">#&gt;         mad     q5 q20 q35 q50 q65 q80 q95      rhat ess_bulk ess_tail</span>
<span class="co">#&gt;  1:  0.0000 239.00 239 239 239 239 239 239        NA       NA       NA</span>
<span class="co">#&gt;  2:  0.0000 186.00 186 186 186 187 187 188 1.0003058 3963.298 3984.764</span>
<span class="co">#&gt;  3:  1.4826 437.00 438 438 439 440 440 442 1.0000644 3933.361 3534.597</span>
<span class="co">#&gt;  4:  2.9652 540.00 542 543 544 544 546 548 1.0000157 4024.752 4021.705</span>
<span class="co">#&gt;  5:  2.9652 512.00 513 515 516 517 518 521 1.0005820 3706.374 3784.917</span>
<span class="co">#&gt;  6:  2.9652 445.00 448 449 450 451 453 456 1.0010980 3923.257 4052.261</span>
<span class="co">#&gt;  7:  4.4478 417.00 420 421 423 424 426 429 1.0006836 3743.629 3466.127</span>
<span class="co">#&gt;  8:  4.4478 328.00 331 332 334 335 337 341 1.0009852 4094.906 4024.037</span>
<span class="co">#&gt;  9:  2.9652 207.00 209 211 212 213 215 218 1.0002365 4068.902 3875.059</span>
<span class="co">#&gt; 10:  4.4478 417.00 420 421 423 425 427 431 1.0005741 3766.858 3729.935</span>
<span class="co">#&gt; 11:  5.9304 554.00 558 561 563 566 569 576 0.9998609 4248.068 3961.904</span>
<span class="co">#&gt; 12:  7.4130 496.00 501 504 507 509 513 520 0.9996200 4236.251 3800.834</span>
<span class="co">#&gt; 13:  7.4130 467.00 472 476 479 482 486 493 0.9994629 3979.093 3507.419</span>
<span class="co">#&gt; 14:  8.8956 468.00 474 478 482 485 489 498 0.9999167 3959.568 3813.239</span>
<span class="co">#&gt; 15:  7.4130 336.00 342 346 349 352 356 363 1.0001986 4436.109 4077.990</span>
<span class="co">#&gt; 16:  5.9304 206.00 210 213 215 218 221 227 1.0007632 4161.274 3680.512</span>
<span class="co">#&gt; 17:  8.8956 427.00 433 437 440 444 448 456 0.9998055 4461.945 4074.851</span>
<span class="co">#&gt; 18: 13.3434 580.00 590 595 600 605 612 624 0.9999442 4218.373 3927.524</span>
<span class="co">#&gt; 19: 13.3434 497.95 508 514 518 524 531 544 0.9996752 4338.009 4079.307</span>
<span class="co">#&gt; 20: 14.8260 466.00 477 484 489 495 503 516 1.0005098 4192.483 4017.986</span>
<span class="co">#&gt; 21: 17.7912 455.00 468 476 483 489 498 516 1.0004409 4921.773 3818.284</span>
<span class="co">#&gt; 22: 14.8260 308.00 320 326 332 338 345 359 0.9996950 4543.923 4052.493</span>
<span class="co">#&gt; 23: 11.8608 193.00 201 207 211 216 221 233 1.0002635 4091.445 3322.759</span>
<span class="co">#&gt; 24: 17.7912 402.00 415 422 428 435 444 460 1.0014179 4267.902 3672.737</span>
<span class="co">#&gt; 25: 23.7216 422.95 439 449 458 467 478 500 1.0001595 4488.251 3825.997</span>
<span class="co">#&gt; 26: 31.1346 441.00 462 474 487 499 515 545 0.9998119 4478.372 3669.178</span>
<span class="co">#&gt; 27: 37.0650 364.00 391 405 419 435 453 489 1.0008798 4455.344 3903.182</span>
<span class="co">#&gt; 28: 50.4084 355.00 388 411 429 449 477 529 0.9997609 4770.492 3698.406</span>
<span class="co">#&gt; 29: 65.2344 305.95 345 370 395 423 456 526 1.0001344 4729.093 3739.025</span>
<span class="co">#&gt; 30: 81.5430 201.00 248 281 309 343 386 469 0.9996385 5569.028 3925.206</span>
<span class="co">#&gt;         mad     q5 q20 q35 q50 q65 q80 q95      rhat ess_bulk ess_tail</span></code></pre></div>
<p>Plot the summarised nowcast against currently observed data (or optionally more recent data for comparison purposes).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nowcast</span>, obs <span class="op">=</span> <span class="va">latest_germany_hosp</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<p>Plot posterior predictions for observed notifications by date of report as a check of how well the model reproduces the observed data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">nowcast</span>, type <span class="op">=</span> <span class="st">"posterior"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">reference_date</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span>
<span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span>
<span class="co">#&gt; the group aesthetic?</span>
<span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span>
<span class="co">#&gt; the group aesthetic?</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If using <code>epinowccast</code> in your work please consider citing it using the following,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; To cite epinowcast in publications use:</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt;   Sam Abbott (2021). epinowcast: Nowcast right censored epidemiological</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt;   count data,</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt;   @Article{,</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt;     title = {epinowcast: Nowcast right censored epidemiological count data},</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt;     author = {Sam Abbott},</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt;     journal = {Zenodo},</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt;     year = {2021},</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-make-a-bug-report-or-feature-request">How to make a bug report or feature request<a class="anchor" aria-label="anchor" href="#how-to-make-a-bug-report-or-feature-request"></a>
</h2>
<p>Please briefly describe your problem and what output you expect in an <a href="https://github.com/seabbs/epinowcast/issues" class="external-link">issue</a>. If you have a question, please don’t open an issue. Instead, ask on our <a href="https://github.com/seabbs/epinowcast/discussions/categories/q-a" class="external-link">Q and A page</a>.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>We welcome contributions and new contributors! We particularly appreciate help on priority problems in the <a href="https://github.com/seabbs/epinowcast/issues" class="external-link">issues</a>. Please check and add to the issues, and/or add a <a href="https://github.com/seabbs/epinowcast/pulls" class="external-link">pull request</a>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>forecast.vocs</code> project is released with a <a href="samabbott.co.uk/epinowcast/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/seabbs/epinowcast/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/seabbs/epinowcast/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing epinowcast</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/seabbs/epinowcast/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/seabbs/epinowcast/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/seabbs/epinowcast" class="external-link"><img src="https://codecov.io/gh/seabbs/epinowcast/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> , using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
